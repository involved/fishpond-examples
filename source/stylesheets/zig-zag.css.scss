$fish-width: 140px;
$fish-spacing: 20px;
$results-width: 460px;
$i: 40;

$row-1-count: 3;
$row-2-count: 4;
$row-3-count: 5;
$row-4-count: 6;
$row-5-count: 6;

@mixin fish-width($row-count){
  // 4:3 Ratio
  $col-width: floor((($results-width) - ($fish-spacing * ($row-count - 1)))/$row-count);
  width: $col-width;
  .thumbnail{
    @include height-transtion(0.5s);
    height: floor($col-width);
  }
}

@mixin width-transtion($duration){
  transition: width $duration;
  -moz-transition: width $duration; /* Firefox 4 */
  -webkit-transition: width $duration; /* Safari and Chrome */
  -o-transition: width $duration; /* Opera */
}

@mixin height-transtion($duration){
  transition: height $duration;
  -moz-transition: height $duration; /* Firefox 4 */
  -webkit-transition: height $duration; /* Safari and Chrome */
  -o-transition: height $duration; /* Opera */
}


@mixin row-ltr{
  border-top: yellow 3px solid;
  //left: $fish-spacing;
}

@mixin row-rtl{
  border-top: green 3px solid;
  //right: $fish-spacing;
}


@mixin col-right{
  //margin-right: 0;
}

#query{
  #results.zigzag{
    width: $results-width;
    background: salmon;
    
    .thumbnails{
      margin-left: 0;
      background: lightgreen;

      .fish{
        @include width-transtion(0.5s);
        
        position: relative;
        width: $fish-width; // backup width
        margin: 0;



        .thumbnail{
          
          border: none;
          padding: 0;
          border: 0;
          box-shadow: none;
          .title,
          .btn{
            display: none !important;
          }
          .details{
            padding: 0 !important;
            margin-bottom: 0 !important;
          }
        }


        &.loading{
          .thumbnail{
            height: 50px;
            background: url(/images/common/loading.gif) no-repeat center center;
            color: #999;
          }
        }
        &.loaded{ }

        //border-top: red 1px solid;
        //border-bottom: red 1px solid;
        //background: green;
        // Fish Scaling and Reszing 
        // Row 1  => 3 fish
        // Row 2  => 4 fish
        // Row 3  => 5 fish
        // Row 4+ => 6 fish

        // Row 1
        $x: 0;
        @for $i from 0 through 2 {


          &[data-pos-start='#{$i}']{
            @include fish-width($row-1-count);
            @include row-ltr;
            float: left;
            margin-top: $x * 20px;
            padding-bottom: ($row-1-count - $x) * 20px;
            left: $x * $fish-spacing;

            @if $x == 0 {
              border-top: red 3px solid !important;
              clear: right;
            }
          }

          $x: $x + 1;
        }

        // Row 2
        $x: 0;
        @for $i from 3 through 6 {
          &[data-pos-start='#{$i}']{
            @include fish-width($row-2-count);
            @include row-rtl;
            float: right;
            margin-top: $x * 10px;
            padding-bottom: ($row-2-count - $x) * 10px;
            right: $x * $fish-spacing;

            @if $x == 0 {
              border-top: orange 3px solid !important;
              clear: left;
            }
          }
          $x: $x + 1
        }

        // Row 3
        $x: 0;
        @for $i from 7 through 11{
          &[data-pos-start='#{$i}']{
            @include fish-width($row-3-count);
            @include row-ltr;
            float: left;
            margin-top: $x * 10px;
            padding-bottom: ($row-3-count - $x) * 10px;
            left: $x * $fish-spacing;

            @if $x == 0 {
              border-top: red 3px solid !important;
              clear: right;
            }
          }
          $x: $x + 1
        }

        // Row 4
        $x: 0;
        @for $i from 12 through 17 {
          &[data-pos-start='#{$i}']{
            @include fish-width($row-4-count);
            @include row-rtl;
            float: right;
            margin-top: $x * 2px;
            padding-bottom: ($row-4-count - $x) * 2px;
            right: $x * $fish-spacing;

            @if $x == 0 {
              border-top: orange 3px solid !important;
              clear: left;
            }
          }
          $x: $x + 1
        }

        // Row 5+
        $x: 0;
        @for $i from 18 through 23 {
          &[data-pos-start='#{$i}']{
            @include fish-width($row-5-count);
            @include row-ltr;
            float: left;
            left: $x * $fish-spacing;
            padding-bottom: 5px;
            margin-top: 5px;
            @if $x == 0 {
              border-top: orange 3px solid !important;
              clear: right;
            }
            @if $x == 5 {
              border-top: purple 3px solid !important;
              clear: right;
            }
          }
          $x: $x + 1
        }

        $x: 0;
        @for $i from 24 through 30 {
          &[data-pos-start='#{$i}']{
            
            @include fish-width($row-5-count);
            @include row-ltr;
            border-top: blue 3px solid;
            float: left;
            left: $x * $fish-spacing;
            padding-bottom: 5px;
        
            @if $x == 0 {
              border-top: orange 3px solid !important;
              clear: left;
            }
            @if $x == 5 {
              border-top: purple 3px solid !important;
              clear: right;
            }
          }
          $x: $x + 1
        }


        &.animating{
          // Row 1   
          @for $i from 0 through 2 {
            &[data-pos-end='#{$i}']{ 
              @include fish-width(3);
            }
          }

          // Row 2
          @for $i from 3 through 6 {
            &[data-pos-end='#{$i}']{  
              @include fish-width(4); 
            }
          }

          // Row 3
          @for $i from 7 through 11 {
            &[data-pos-end='#{$i}']{ 
              @include fish-width(5); 
            }
          }

          // Row 4
          @for $i from 12 through 40 {
            &[data-pos-end='#{$i}']{
              @include fish-width(6);
            }
          }
        }
      }
    }
  }  
}